<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>5-User Chat</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }

        #chat {
            border: 1px solid #ccc;
            height: 300px;
            overflow-y: auto;
            padding: 10px;
        }

        input {
            padding: 10px;
            width: 80%;
        }

        button {
            padding: 10px;
        }

        .system {
            color: gray;
            font-style: italic;
        }

        .me {
            color: blue;
        }
    </style>
</head>

<body>
    <h2>Live Chat (max 5 users)</h2>
    <div id="chat"></div>
    <input id="message" placeholder="Type a message..." />
    <button onclick="sendMessage()">Send</button>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();

        const chat = document.getElementById('chat');
        const input = document.getElementById('message');

        function addMessage(text, cls = "") {
            const div = document.createElement('div');
            div.textContent = text;
            if (cls) div.className = cls;
            chat.appendChild(div);
            chat.scrollTop = chat.scrollHeight;
        }

        socket.on('chat:info', (msg) => addMessage(msg, 'system'));
        socket.on('chat:message', (data) => {
            const cls = data.id === socket.id ? 'me' : '';
            addMessage(`${data.id}: ${data.text}`, cls);
        });
        socket.on('chat:full', (msg) => {
            alert(msg);
        });

        function sendMessage() {
            const msg = input.value;
            if (!msg) return;
            socket.emit('chat:message', msg);
            input.value = "";
        }

        input.addEventListener('keyup', (e) => {
            if (e.key === 'Enter') sendMessage();
        });
    </script>
</body>

</html>